üìå –ö–æ–Ω—Ç–µ–∫—Å—Ç: RegisterOnShutdown(...)

–ö–æ–≥–¥–∞ —Ç—ã —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—à—å —Ñ—É–Ω–∫—Ü–∏—é —á–µ—Ä–µ–∑ RegisterOnShutdown, –æ–Ω–∞ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞ –≤–Ω—É—Ç—Ä–∏ Shutdown(), –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ ‚Äî —Ç–æ –µ—Å—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≥–æ—Ä—É—Ç–∏–Ω–µ.

–ò –≤–æ—Ç –∑–¥–µ—Å—å –≤–∞–∂–Ω–æ:
‚ùå –ß—Ç–æ –Ω–µ–ª—å–∑—è –¥–µ–ª–∞—Ç—å:

srv.RegisterOnShutdown(func() {
    // ‚ùå –ñ–¥–∞—Ç—å —á–µ–≥–æ-—Ç–æ
    time.Sleep(5 * time.Second) // –∏–ª–∏ wg.Wait(), <-done, –∏ —Ç.–¥.
})

–≠—Ç–æ –ø–ª–æ—Ö–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ Shutdown() –Ω–µ –∂–¥—ë—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π ‚Äî —Ç—ã —Å–∞–º –¥–æ–ª–∂–µ–Ω —ç—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ.

–ü–æ—Ç–æ–º—É —á—Ç–æ RegisterOnShutdown –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –Ω–µ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è, –∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è.

    –î—É–º–∞–µ–º –æ–± —ç—Ç–æ–º —Ç–∞–∫:

    "–ö–æ–≥–¥–∞ Shutdown –Ω–∞—á–Ω—ë—Ç—Å—è, –º—ã —Ç–µ–±–µ –¥–∞–¥–∏–º —à–∞–Ω—Å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–∏–≥–Ω–∞–ª—ã –≤—Å–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º –∏ —Ä–µ—Å—É—Ä—Å–∞–º, —á—Ç–æ–±—ã –æ–Ω–∏ —Å–∞–º–∏ –Ω–∞—á–∞–ª–∏ –∑–∞–∫—Ä—ã–≤–∞—Ç—å—Å—è. 
    –ê –≤–æ—Ç –∂–¥–∞—Ç—å, –ø–æ–∫–∞ –æ–Ω–∏ –∑–∞–∫—Ä–æ—é—Ç—Å—è, —Ç—ã –¥–æ–ª–∂–µ–Ω –≥–¥–µ-—Ç–æ –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ."

